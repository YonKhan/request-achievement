var app = angular.module('achievement',[]);
app.config(['$httpProvider', function($httpProvider) {        $httpProvider.defaults.useXDomain = true;        delete $httpProvider.defaults.headers.common['X-Requested-With'];    }]);	var data = {};	$.getJSON('https://eu.api.battle.net/wow/data/character/achievements?locale=fr_FR&apikey=xyzcvd8sfjx5sketq27e8ttsvdbnttgm', function(dataJSON) {			data = dataJSON;			$("#loader").hide();	});var urlAPI = "http://localhost:8080";app.controller('achievementController',function($http, $scope){	$scope.seekAchievement = function(){		if (_.isUndefined(data) ||_.isUndefined($scope.someVal)) {			return;		}		var valueSearch = $scope.someVal.toLowerCase();		$scope.resultsAchievements = [];		_.each(data.achievements, function(results) {				checkIsAchievement(results);			_.each(results.categories, function(results) {					checkIsAchievement(results);	  	});			function checkIsAchievement(results) {				_.each(results.achievements, function(results) {					var title 		  = results.title.toLowerCase();					var description = results.description.toLowerCase();					if(_.isUndefined(results) && _.isUndefined(title)) {						return;			    }					if (title.indexOf(valueSearch) >= 0 || description.indexOf(valueSearch) >= 0) {			    		$scope.resultsAchievements.push(results);			    }				});			}		});		var refreshGroupsForAchievement = function(idAchievement) {			$http.get(urlAPI+'/groupsachievement/' + idAchievement).success(function(response) {				$scope.groups = response;				$scope.group 	= "";				$scope.newGroup = "";				$scope.emptyGroupAchievement = "";				if (!response.length) {					$scope.emptyGroupAchievement = idAchievement;				}			});		};		$scope.getGroups = function(id) {			refreshGroupsForAchievement(id);		};		//Arevoir		var newGroupIdAchievementvar;		$scope.newGroupIdAchievement =  function(id) {			newGroupIdAchievementvar = id;		};		$scope.addGroup = function() {			var newGroup =  $scope.newGroup;			newGroup.idAchievement = newGroupIdAchievementvar;			newGroup.dateCreate = new Date();			console.log(newGroup);			$http.post(urlAPI+'/groups', newGroup).success(function(response) {				refreshGroupsForAchievement(newGroupIdAchievementvar);			});		};	}});
